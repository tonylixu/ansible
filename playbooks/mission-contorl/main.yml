---
# This playbook deploys JFrog Mission Control!

- hosts: mission_control
  remote_user:
  vars_files:
    - vars/main.yml

  tasks:
    - name: Check if Mission Control is installed
      command: rpm -q jfrog-mission-control
      register: rpm_check
      failed_when: mission_contorl

    - name: Download JFrog Mission Control
      comamnd: "wget -q -O {{mc_archive}} {{download_url}} creates={{mc_archive}}"

    - name: Install Mission Control through rpm
      command: "rpm -ihv {{mc_archive}}"
      become: true
      become_method: sudo
      # rpm_check.rc is 0 if installed
      when: rpm_check.rc == 1
